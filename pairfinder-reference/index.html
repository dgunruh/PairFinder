<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>PairFinder - My Docs</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "PairFinder";
    var mkdocs_page_input_path = "pairfinder-reference.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> My Docs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../tutorial1/">Tutorial 1</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Code Reference</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">PairFinder</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#pairfinder.src.best_pairs_finder.BestPairsFinder">pairfinder.src.best_pairs_finder.BestPairsFinder</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pairfinder.src.best_pairs_finder.BestPairsFinder.__init__">__init__()</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pairfinder.src.best_pairs_finder.BestPairsFinder.find_best_pairs">find_best_pairs()</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#pairfinder.src.best_pairs_finder.BestPairsFinder.find_best_pairs--parameters">Parameters</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#pairfinder.src.best_pairs_finder.BestPairsFinder.find_best_pairs--returns">Returns</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#pairfinder.src.best_pairs_finder.BestPairsFinder.find_best_pairs--examples">Examples</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">My Docs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Code Reference &raquo;</li>
        
      
    
    <li>PairFinder</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="pairfinder-module">PairFinder module</h1>


  <div class="doc doc-object doc-class">

<a id="pairfinder.src.best_pairs_finder.BestPairsFinder"></a>
    <div class="doc doc-contents first">

      <p>Pair particles together such that the total distance is minimized.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h2 id="pairfinder.src.best_pairs_finder.BestPairsFinder.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h2>

    <div class="doc doc-contents ">

      <p>Init function.</p>

        <details class="quote">
          <summary>Source code in <code>pairfinder/src/best_pairs_finder.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Init function.&quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h2 id="pairfinder.src.best_pairs_finder.BestPairsFinder.find_best_pairs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_best_pairs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">particle_positions</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;greedy&#39;</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Find pairs of closest particles given their coordinates. Multiple
methods are implemented, and each method functions slightly
differently. The methods are:</p>
<p>Enumerate method:</p>
<pre><code>1. Check that the input is iterable

2. Enumerate every possible particle pairing

3. Create combinations of these pairs to include every particle

4. Return the combination that has the smallest summed distance
</code></pre>
<p>Graph method (both greedy and COM):</p>
<pre><code>1. Check that the input is iterable

2. Save particle index to coordinate/ position in a dictionary

3. Create distance matrix between all points (N x N)

4. Pair particles using greedy or center of mass approach

5. Convert paired particles from indices to coordinates and return
</code></pre>
<p>Simulated annealing method:</p>
<pre><code>1. Check that the input particles object is iterable

2. Create initial pairs of particles using various methods:

    2a. Linear pairing (pair in order of indices)

    2b. Random pairing (pair randomly until no particles remain)

    2c. Greedy pairing (pair particles in smallest distance order)

3. Run simulated annealing with set beta parameters (max, min and
    step size), and number of annealing steps per beta step.
</code></pre>
<h4 id="pairfinder.src.best_pairs_finder.BestPairsFinder.find_best_pairs--parameters">Parameters</h4>
<p>particle_positions : <code>list</code></p>
<pre><code>positions of N particles in D dimensions
</code></pre>
<p>method : <code>string</code>, <em>optional</em></p>
<pre><code>The method by which the best pairs are found. Options are
"enumerate", "greedy", "COM" and "simulated-annealing".
By default, the method is `"greedy"`.
</code></pre>
<h4 id="pairfinder.src.best_pairs_finder.BestPairsFinder.find_best_pairs--returns">Returns</h4>
<p>paired_particles : <code>list</code></p>
<pre><code>Combination of pairs which minimizes the overall distances
between particles.
</code></pre>
<h4 id="pairfinder.src.best_pairs_finder.BestPairsFinder.find_best_pairs--examples">Examples</h4>
<p>Find the optimal pairing of 6 particles in 2-dimensions using the
<code>"greedy"</code> graph approach:</p>
<pre><code>&gt;&gt;&gt; finder = BestPairsFinder()
&gt;&gt;&gt; particle_positions = create_even_number_of_particles(6, 2, seed=42)
&gt;&gt;&gt; pairing, distance = finder.find_best_pairs(particle_positions,                method='greedy')
</code></pre>

        <details class="quote">
          <summary>Source code in <code>pairfinder/src/best_pairs_finder.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_best_pairs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">particle_positions</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;greedy&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find pairs of closest particles given their coordinates. Multiple</span>
<span class="sd">    methods are implemented, and each method functions slightly</span>
<span class="sd">    differently. The methods are:</span>

<span class="sd">    Enumerate method:</span>

<span class="sd">        1. Check that the input is iterable</span>

<span class="sd">        2. Enumerate every possible particle pairing</span>

<span class="sd">        3. Create combinations of these pairs to include every particle</span>

<span class="sd">        4. Return the combination that has the smallest summed distance</span>

<span class="sd">    Graph method (both greedy and COM):</span>

<span class="sd">        1. Check that the input is iterable</span>

<span class="sd">        2. Save particle index to coordinate/ position in a dictionary</span>

<span class="sd">        3. Create distance matrix between all points (N x N)</span>

<span class="sd">        4. Pair particles using greedy or center of mass approach</span>

<span class="sd">        5. Convert paired particles from indices to coordinates and return</span>

<span class="sd">    Simulated annealing method:</span>

<span class="sd">        1. Check that the input particles object is iterable</span>

<span class="sd">        2. Create initial pairs of particles using various methods:</span>

<span class="sd">            2a. Linear pairing (pair in order of indices)</span>

<span class="sd">            2b. Random pairing (pair randomly until no particles remain)</span>

<span class="sd">            2c. Greedy pairing (pair particles in smallest distance order)</span>

<span class="sd">        3. Run simulated annealing with set beta parameters (max, min and</span>
<span class="sd">            step size), and number of annealing steps per beta step.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    particle_positions : `list`</span>

<span class="sd">        positions of N particles in D dimensions</span>

<span class="sd">    method : `string`, *optional*</span>

<span class="sd">        The method by which the best pairs are found. Options are</span>
<span class="sd">        &quot;enumerate&quot;, &quot;greedy&quot;, &quot;COM&quot; and &quot;simulated-annealing&quot;.</span>
<span class="sd">        By default, the method is `&quot;greedy&quot;`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    paired_particles : `list`</span>

<span class="sd">        Combination of pairs which minimizes the overall distances</span>
<span class="sd">        between particles.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Find the optimal pairing of 6 particles in 2-dimensions using the</span>
<span class="sd">    `&quot;greedy&quot;` graph approach:</span>

<span class="sd">        &gt;&gt;&gt; finder = BestPairsFinder()</span>
<span class="sd">        &gt;&gt;&gt; particle_positions = create_even_number_of_particles(6, 2, seed=42)</span>
<span class="sd">        &gt;&gt;&gt; pairing, distance = finder.find_best_pairs(particle_positions,\</span>
<span class="sd">            method=&#39;greedy&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;enumerate&#39;</span><span class="p">:</span>
        <span class="c1"># Step 1: Check that particle_positions is iterable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_iterable</span><span class="p">(</span><span class="n">particle_positions</span><span class="p">)</span>
        <span class="c1"># Step 2: Enumerate all pairs of particles</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_pairs</span><span class="p">(</span><span class="n">particle_positions</span><span class="p">)</span>
        <span class="c1"># Step 3: Create combinations of these pairs</span>
        <span class="n">combos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_combinations</span><span class="p">(</span>
            <span class="n">pairs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">particle_positions</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">particle_positions</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># Step 4: Return minimum distance combination (and its distance)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_choose_best_combination</span><span class="p">(</span><span class="n">combos</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;greedy&#39;</span><span class="p">,</span> <span class="s1">&#39;COM&#39;</span><span class="p">]:</span>
        <span class="c1"># Step 1: Check that particle_positions is iterable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_iterable</span><span class="p">(</span><span class="n">particle_positions</span><span class="p">)</span>
        <span class="c1"># Step 2: Save index to coordinate map</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">idx_to_coord_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">coord</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span>
                                 <span class="nb">enumerate</span><span class="p">(</span><span class="n">particle_positions</span><span class="p">)}</span>
        <span class="c1"># Step 3: Create distance matrix between all points</span>
        <span class="n">distance_mtx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_distance_matrix</span><span class="p">(</span><span class="n">particle_positions</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">particle_positions</span><span class="p">)</span>
        <span class="c1"># set diagonal to inf to prevent selecting self</span>
        <span class="n">distance_mtx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">distance_mtx</span><span class="p">)</span>
        <span class="n">distance_mtx</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="n">distance_mtx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">distance_mtx</span><span class="p">)</span>
        <span class="c1"># Step 4: Pair particles based on specified method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pairs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_get_pairs_from_distance_matrix</span><span class="p">(</span><span class="n">distance_mtx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pairs</span><span class="p">,</span>
                                             <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
        <span class="c1"># Step 5: Convert particle indices to coordinates using map</span>
        <span class="n">converted_pairing</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_to_coord_map</span><span class="p">[</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">idx_to_coord_map</span><span class="p">[</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
                             <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pairs</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">converted_pairing</span><span class="p">,</span>\
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_summed_pair_distance</span><span class="p">(</span><span class="n">converted_pairing</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;simulated_annealing&#39;</span><span class="p">:</span>
        <span class="c1"># Step 1: Check that particle_positions is iterable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_iterable</span><span class="p">(</span><span class="n">particle_positions</span><span class="p">)</span>
        <span class="c1"># Step 2: Create initial pairing of particles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pairs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_single_combination</span><span class="p">(</span>
            <span class="n">particle_positions</span><span class="p">,</span> <span class="s2">&quot;greedy&quot;</span><span class="p">)</span>
        <span class="c1"># Run simulated annealing with set parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_simulated_annealing</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pairs</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pairs</span><span class="p">,</span>\
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_summed_pair_distance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pairs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../tutorial1/" class="btn btn-neutral" title="Tutorial 1"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../tutorial1/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
